<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Weather Map Project</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
</head>
<body>
	<div class="container">
		<h1>5-Day Forecast</h1>
		<section id="forecast" class="row"></section>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-2.2.4.js" integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI=" crossorigin="anonymous"></script>
	<script src="js/keys.js"></script>
	<script>
		"use strict";
		$(document).ready(function () {
			function findDay(timestamp) {
				let date = new Date(timestamp * 1000);
				return date.getDay();
			}

			function findDate(timestamp) {
				let date = new Date(timestamp * 1000);
				return date.toDateString();
			}

			$.get("https://api.openweathermap.org/data/2.5/onecall", {
				appid: OPEN_WEATHER_APPID,
				lat: 29.4241,
				lon: -98.4936,
				units: "imperial"
			}).done(function (data) {
				console.log(data);
				let firstDay = findDay(data.daily[0].dt);
				for (let i = 0; i < 5; i++) {
					let card = document.createElement("div");
					card.setAttribute("class", "card, col");
					let day = i + firstDay;
					if (day > 6) {
						day -= 7;
					}
					card.setAttribute("id", "day" + day);
					$("#forecast").append(card);
				}
				data.daily.forEach(function (forecast) {
					let forecastDate = forecast.dt;
					let day = findDay(forecastDate);
					if (!document.getElementById("day" + day + "date")) {
						let dateHeader = document.createElement("div");
						dateHeader.setAttribute("class", "card-title")
						dateHeader.setAttribute("id", "day" + day + "date");
						dateHeader.innerText = findDate(forecastDate);
						$("#day" + day).append(dateHeader);
					}
					if (!document.getElementById("day" + day + "temp")) {
						let dailyTemp = document.createElement("div");
						dailyTemp.setAttribute("class", "card-text")
						dailyTemp.setAttribute("id", "day" + day + "temp");
						dailyTemp.innerHTML = Math.floor(forecast.temp.min) + "&#8457;" + " / " + Math.floor(forecast.temp.max) + "&#8457;";
						$("#day" + day).append(dailyTemp);
					}
					if (!document.getElementById("day" + day + "humidity")) {
						let dailyHumidity = document.createElement("div");
						dailyHumidity.setAttribute("class", "card-text")
						dailyHumidity.setAttribute("id", "day" + day + "humidity");
						dailyHumidity.innerHTML = "Humidity: " + forecast.humidity;
						$("#day" + day).append(dailyHumidity);
					}
					if (!document.getElementById("day" + day + "wind")) {
						let dailyWind = document.createElement("div");
						dailyWind.setAttribute("class", "card-text")
						dailyWind.setAttribute("id", "day" + day + "wind");
						dailyWind.innerHTML = "Wind Speed: " + forecast.wind_speed;
						$("#day" + day).append(dailyWind);
					}
				});
			});
		});
	</script>
</body>
</html>